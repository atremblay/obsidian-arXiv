/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => main_default
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var fs = __toESM(require("fs"));
var path = __toESM(require("path"));
var DEFAULT_SETTINGS = {
  mySetting: ""
};
var ArxivPlugin = class extends import_obsidian.Plugin {
  async fetchPaper(paperId, paperName) {
    if (paperId) {
      try {
        const data = await this.fetchPaperData(paperId, paperName);
        await this.createNote(data);
      } catch (error) {
        console.error("Error fetching paper data:", error);
        new import_obsidian.Notice(`Error fetching paper data: ${paperId}`);
      }
    }
  }
  fetchPaperData(id, name) {
    return new Promise((resolve2, reject) => {
      const url = `http://export.arxiv.org/api/query?id_list=${id}`;
      const xhr = new XMLHttpRequest();
      xhr.open("GET", url);
      xhr.onreadystatechange = () => {
        var _a, _b, _c, _d, _e;
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xhr.responseText, "application/xml");
            const entry = xmlDoc.querySelector("entry");
            if (entry) {
              const title = ((_a = entry.querySelector("title")) == null ? void 0 : _a.textContent) || "No Title";
              const authors = Array.from(entry.querySelectorAll("author name")).map((el) => el.textContent).join(", ") || "No Authors";
              const publicationDateRaw = (_b = entry.querySelector("published")) == null ? void 0 : _b.textContent;
              const publicationDate = publicationDateRaw ? new Date(publicationDateRaw).toISOString().split("T")[0] : "No Publication Date";
              const url2 = ((_c = entry.querySelector("id")) == null ? void 0 : _c.textContent) || "No URL";
              let summary = ((_d = entry.querySelector("summary")) == null ? void 0 : _d.textContent) || "No Summary";
              summary = summary.replace(/(\r\n|\n|\r)/gm, " ").trim();
              const pdfLink = ((_e = xmlDoc.querySelector('link[title="pdf"]')) == null ? void 0 : _e.getAttribute("href")) || "No PDF Link";
              if (name === void 0) {
                name = id;
              }
              resolve2({ title, authors, publicationDate, summary, id, url: url2, pdfLink, name });
            } else {
              reject(new Error("No entry found in the response"));
            }
          } else {
            reject(new Error("Failed to fetch data"));
          }
        }
      };
      xhr.send();
    });
  }
  async createNote(data) {
    const authorsList = data.authors.split(", ").map((author) => `  - "${author}"`).join("\n");
    const frontMatter = `---
title: "${data.title}"
authors:
${authorsList}
published: "${data.publicationDate}"
arXiv: "${data.url}"
paper: "${data.pdfLink}"
---
`;
    const content = `
#### Abstract

${data.summary}
		`;
    await this.app.vault.create(`${this.settings.mySetting}/${data.name}.md`, frontMatter + content);
    new import_obsidian.Notice(`Created note: ${data.name}`);
  }
  async onload() {
    await this.loadSettings();
    try {
      const arXivLogo = await this.readSVGFile();
      (0, import_obsidian.addIcon)("arXiv", arXivLogo);
      const ribbonIconEl = this.addRibbonIcon("arXiv", "arXiv fetch paper", () => {
        new ArXivModal(this.app, (paperId, paperName) => {
          this.fetchPaper(paperId, paperName);
        }).open();
      });
      ribbonIconEl.addClass("my-plugin-ribbon-class");
    } catch (error) {
      console.error("Error:", error);
    }
    const statusBarItemEl = this.addStatusBarItem();
    statusBarItemEl.setText("Status Bar Text");
    this.addCommand({
      id: "open-arXiv-modal",
      name: "Fetch arXiv paper info",
      callback: () => {
        new ArXivModal(this.app, (paperId, paperName) => {
          this.fetchPaper(paperId, paperName);
        }).open();
      }
    });
    this.addSettingTab(new ArXivSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async readSVGFile() {
    const filePath = path.resolve(
      this.app.vault.adapter.basePath,
      this.manifest.dir,
      "arxiv-logomark.svg"
    );
    return new Promise((resolve2, reject) => {
      fs.readFile(filePath, "utf8", (err, data) => {
        if (err) {
          console.error("Error reading SVG file:", err);
          reject(err);
        } else {
          resolve2(data);
        }
      });
    });
  }
};
var ArXivSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Save path").setDesc("Enter the path where you want to save the file").addText((text) => text.setValue(this.plugin.settings.mySetting).onChange(async (value) => {
      console.log("setting value: ", value);
      this.plugin.settings.mySetting = value;
      await this.plugin.saveSettings();
    }));
  }
};
var ArXivModal = class extends import_obsidian.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    new import_obsidian.Setting(contentEl).setName("arXiv id:").addText((text) => text.onChange((value) => {
      this.arXivID = value;
    }));
    new import_obsidian.Setting(contentEl).setName("Paper name (optional):").addText((text) => text.onChange((value) => {
      this.paperName = value;
    }));
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Fetch").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.arXivID, this.paperName);
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var main_default = ArxivPlugin;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgYWRkSWNvbiwgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuLy8gUmVtZW1iZXIgdG8gcmVuYW1lIHRoZXNlIGNsYXNzZXMgYW5kIGludGVyZmFjZXMhXG5cbmludGVyZmFjZSBBclhpdlBsdWdpblNldHRpbmdzIHtcblx0bXlTZXR0aW5nOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQYXBlckRhdGEge1xuICB0aXRsZTogc3RyaW5nO1xuICBhdXRob3JzOiBzdHJpbmc7XG4gIHB1YmxpY2F0aW9uRGF0ZTogc3RyaW5nO1xuICBzdW1tYXJ5OiBzdHJpbmc7XG4gIGlkOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBwZGZMaW5rOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQXJYaXZQbHVnaW5TZXR0aW5ncyA9IHtcblx0bXlTZXR0aW5nOiAnJ1xufVxuXG5jbGFzcyBBcnhpdlBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBBclhpdlBsdWdpblNldHRpbmdzO1xuXG5cdGFzeW5jIGZldGNoUGFwZXIocGFwZXJJZDogc3RyaW5nLCBwYXBlck5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmIChwYXBlcklkKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5mZXRjaFBhcGVyRGF0YShwYXBlcklkLCBwYXBlck5hbWUpO1xuXHRcdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZU5vdGUoZGF0YSk7XG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwYXBlciBkYXRhOicsIGVycm9yKTtcblx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3IgZmV0Y2hpbmcgcGFwZXIgZGF0YTogJHtwYXBlcklkfWApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZldGNoUGFwZXJEYXRhKGlkOiBzdHJpbmcsIG5hbWU6c3RyaW5nKTogUHJvbWlzZTxQYXBlckRhdGE+IHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0Y29uc3QgdXJsID0gYGh0dHA6Ly9leHBvcnQuYXJ4aXYub3JnL2FwaS9xdWVyeT9pZF9saXN0PSR7aWR9YDtcblx0XHRcdFx0Y29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHR4aHIub3BlbignR0VUJywgdXJsKTtcblx0XHRcdHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG5cdFx0XHRcdGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuXHRcdFx0XHRcdGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcblx0XHRcdFx0XHRcdGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblx0XHRcdFx0XHRcdGNvbnN0IHhtbERvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoeGhyLnJlc3BvbnNlVGV4dCwgJ2FwcGxpY2F0aW9uL3htbCcpO1xuXHRcdFx0XHRcdFx0Y29uc3QgZW50cnkgPSB4bWxEb2MucXVlcnlTZWxlY3RvcignZW50cnknKTtcblxuXHRcdFx0XHRcdFx0aWYgKGVudHJ5KSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHRpdGxlID0gZW50cnkucXVlcnlTZWxlY3RvcigndGl0bGUnKT8udGV4dENvbnRlbnQgfHwgJ05vIFRpdGxlJztcblx0XHRcdFx0XHRcdFx0Y29uc3QgYXV0aG9ycyA9IEFycmF5LmZyb20oZW50cnkucXVlcnlTZWxlY3RvckFsbCgnYXV0aG9yIG5hbWUnKSkubWFwKGVsID0+IGVsLnRleHRDb250ZW50KS5qb2luKCcsICcpIHx8ICdObyBBdXRob3JzJztcblx0XHRcdFx0XHRcdFx0Y29uc3QgcHVibGljYXRpb25EYXRlUmF3ID0gZW50cnkucXVlcnlTZWxlY3RvcigncHVibGlzaGVkJyk/LnRleHRDb250ZW50O1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwdWJsaWNhdGlvbkRhdGUgPSBwdWJsaWNhdGlvbkRhdGVSYXcgPyAobmV3IERhdGUocHVibGljYXRpb25EYXRlUmF3KSkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdIDogJ05vIFB1YmxpY2F0aW9uIERhdGUnO1xuXHRcdFx0XHRcdFx0XHRjb25zdCB1cmwgPSBlbnRyeS5xdWVyeVNlbGVjdG9yKCdpZCcpPy50ZXh0Q29udGVudCB8fCAnTm8gVVJMJztcblx0XHRcdFx0XHRcdFx0bGV0IHN1bW1hcnkgPSBlbnRyeS5xdWVyeVNlbGVjdG9yKCdzdW1tYXJ5Jyk/LnRleHRDb250ZW50IHx8ICdObyBTdW1tYXJ5Jztcblx0XHRcdFx0XHRcdFx0c3VtbWFyeSA9IHN1bW1hcnkucmVwbGFjZSgvKFxcclxcbnxcXG58XFxyKS9nbSwgXCIgXCIpLnRyaW0oKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcGRmTGluayA9IHhtbERvYy5xdWVyeVNlbGVjdG9yKCdsaW5rW3RpdGxlPVwicGRmXCJdJyk/LmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8ICdObyBQREYgTGluayc7XG5cblx0XHRcdFx0XHRcdFx0aWYgKG5hbWUgPT09IHVuZGVmaW5lZCl7XG5cdFx0XHRcdFx0XHRcdFx0bmFtZSA9IGlkO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoeyB0aXRsZSwgYXV0aG9ycywgcHVibGljYXRpb25EYXRlLCBzdW1tYXJ5ICwgaWQsIHVybCwgcGRmTGluaywgbmFtZX0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KG5ldyBFcnJvcignTm8gZW50cnkgZm91bmQgaW4gdGhlIHJlc3BvbnNlJykpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggZGF0YScpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHR4aHIuc2VuZCgpO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlTm90ZShkYXRhOiBQYXBlckRhdGEpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBhdXRob3JzTGlzdCA9IGRhdGEuYXV0aG9ycy5zcGxpdCgnLCAnKS5tYXAoYXV0aG9yID0+IGAgIC0gXCIke2F1dGhvcn1cImApLmpvaW4oJ1xcbicpO1xuXHRcdGNvbnN0IGZyb250TWF0dGVyID0gYC0tLVxudGl0bGU6IFwiJHtkYXRhLnRpdGxlfVwiXG5hdXRob3JzOlxuJHthdXRob3JzTGlzdH1cbnB1Ymxpc2hlZDogXCIke2RhdGEucHVibGljYXRpb25EYXRlfVwiXG5hclhpdjogXCIke2RhdGEudXJsfVwiXG5wYXBlcjogXCIke2RhdGEucGRmTGlua31cIlxuLS0tXG5gO1xuXG5cdFx0Y29uc3QgY29udGVudCA9IGBcbiMjIyMgQWJzdHJhY3RcblxuJHtkYXRhLnN1bW1hcnl9XG5cdFx0YDtcblxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShgJHt0aGlzLnNldHRpbmdzLm15U2V0dGluZ30vJHtkYXRhLm5hbWV9Lm1kYCwgZnJvbnRNYXR0ZXIgKyBjb250ZW50KTtcblx0XHRuZXcgTm90aWNlKGBDcmVhdGVkIG5vdGU6ICR7ZGF0YS5uYW1lfWApO1xuXHR9XG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGFyWGl2TG9nbyA9IGF3YWl0IHRoaXMucmVhZFNWR0ZpbGUoKTtcblx0XHRcdGFkZEljb24oJ2FyWGl2JywgYXJYaXZMb2dvKTtcblxuXHRcdFx0Y29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKFwiYXJYaXZcIiwgXCJhclhpdiBmZXRjaCBwYXBlclwiLCAoKSA9PiB7XG5cdFx0XHRcdG5ldyBBclhpdk1vZGFsKHRoaXMuYXBwLCAocGFwZXJJZCwgcGFwZXJOYW1lKSA9PiB7XG5cdFx0XHRcdHRoaXMuZmV0Y2hQYXBlcihwYXBlcklkLCBwYXBlck5hbWUpO1xuXHRcdFx0XHR9KS5vcGVuKCk7XG5cdFx0XHR9KTtcblx0XHRcdHJpYmJvbkljb25FbC5hZGRDbGFzcygnbXktcGx1Z2luLXJpYmJvbi1jbGFzcycpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnUmVjZWl2ZWQgZGF0YTonLCBkYXRhKTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3I6JywgZXJyb3IpO1xuXHRcdH1cblxuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc3RhdHVzIGJhciBpdGVtIHRvIHRoZSBib3R0b20gb2YgdGhlIGFwcC4gRG9lcyBub3Qgd29yayBvbiBtb2JpbGUgYXBwcy5cblx0XHRjb25zdCBzdGF0dXNCYXJJdGVtRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcblx0XHRzdGF0dXNCYXJJdGVtRWwuc2V0VGV4dCgnU3RhdHVzIEJhciBUZXh0Jyk7XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzaW1wbGUgY29tbWFuZCB0aGF0IGNhbiBiZSB0cmlnZ2VyZWQgYW55d2hlcmVcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdvcGVuLWFyWGl2LW1vZGFsJyxcblx0XHRcdG5hbWU6ICdGZXRjaCBhclhpdiBwYXBlciBpbmZvJyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdG5ldyBBclhpdk1vZGFsKHRoaXMuYXBwLCAocGFwZXJJZCwgcGFwZXJOYW1lKSA9PiB7XG5cdFx0XHRcdHRoaXMuZmV0Y2hQYXBlcihwYXBlcklkLCBwYXBlck5hbWUpO1xuXHRcdFx0XHR9KS5vcGVuKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQXJYaXZTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxuXHRhc3luYyByZWFkU1ZHRmlsZSgpOiBQcm9taXNlPHN0cmluZz4ge1xuXG5cdFx0Y29uc3QgZmlsZVBhdGggPSBwYXRoLnJlc29sdmUoXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmJhc2VQYXRoLCBcblx0XHRcdHRoaXMubWFuaWZlc3QuZGlyLFxuXHRcdFx0J2FyeGl2LWxvZ29tYXJrLnN2Zydcblx0XHQpO1xuXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdGZzLnJlYWRGaWxlKGZpbGVQYXRoLCAndXRmOCcsIChlcnIsIGRhdGEpID0+IHtcblx0XHRcdFx0aWYgKGVycikge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgU1ZHIGZpbGU6JywgZXJyKTtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxufVxuXG5cbmNsYXNzIEFyWGl2U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEFyeGl2UGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEFyeGl2UGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdTYXZlIHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ0VudGVyIHRoZSBwYXRoIHdoZXJlIHlvdSB3YW50IHRvIHNhdmUgdGhlIGZpbGUnKVxuXHRcdFx0LmFkZFRleHQodGV4dCA9PiB0ZXh0XG5cdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5teVNldHRpbmcpXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnc2V0dGluZyB2YWx1ZTogJywgdmFsdWUpO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm15U2V0dGluZyA9IHZhbHVlO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KSk7XG5cdH1cbn1cblxuY2xhc3MgQXJYaXZNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgYXJYaXZJRDogc3RyaW5nO1xuICBwYXBlck5hbWU6IHN0cmluZztcbiAgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChhclhpdklEOiBzdHJpbmcsIHBhcGVyTmFtZTogc3RyaW5nKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gIH1cblxuICBvbk9wZW4oKSB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiYXJYaXYgaWQ6XCIpXG4gICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgdGV4dC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLmFyWGl2SUQgPSB2YWx1ZVxuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuc2V0TmFtZShcIlBhcGVyIG5hbWUgKG9wdGlvbmFsKTpcIilcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxuICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGFwZXJOYW1lID0gdmFsdWVcbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICBidG5cbiAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkZldGNoXCIpXG4gICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5vblN1Ym1pdCh0aGlzLmFyWGl2SUQsIHRoaXMucGFwZXJOYW1lKTtcbiAgICAgICAgICB9KSk7XG4gIH1cblxuICBvbkNsb3NlKCkge1xuICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFyeGl2UGx1Z2luO1xuXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUFxRztBQUNyRyxTQUFvQjtBQUNwQixXQUFzQjtBQW1CdEIsSUFBTSxtQkFBd0M7QUFBQSxFQUM3QyxXQUFXO0FBQ1o7QUFFQSxJQUFNLGNBQU4sY0FBMEIsdUJBQU87QUFBQSxFQUdoQyxNQUFNLFdBQVcsU0FBaUIsV0FBa0M7QUFDbkUsUUFBSSxTQUFTO0FBQ1osVUFBSTtBQUNILGNBQU0sT0FBTyxNQUFNLEtBQUssZUFBZSxTQUFTLFNBQVM7QUFDekQsY0FBTSxLQUFLLFdBQVcsSUFBSTtBQUFBLE1BQzNCLFNBQVMsT0FBUDtBQUNELGdCQUFRLE1BQU0sOEJBQThCLEtBQUs7QUFDakQsWUFBSSx1QkFBTyw4QkFBOEIsU0FBUztBQUFBLE1BQ25EO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLGVBQWUsSUFBWSxNQUFpQztBQUMzRCxXQUFPLElBQUksUUFBUSxDQUFDQSxVQUFTLFdBQVc7QUFDdkMsWUFBTSxNQUFNLDZDQUE2QztBQUN4RCxZQUFNLE1BQU0sSUFBSSxlQUFlO0FBQ2hDLFVBQUksS0FBSyxPQUFPLEdBQUc7QUFDbkIsVUFBSSxxQkFBcUIsTUFBTTtBQTdDbEM7QUE4Q0ksWUFBSSxJQUFJLGVBQWUsR0FBRztBQUN6QixjQUFJLElBQUksV0FBVyxLQUFLO0FBQ3ZCLGtCQUFNLFNBQVMsSUFBSSxVQUFVO0FBQzdCLGtCQUFNLFNBQVMsT0FBTyxnQkFBZ0IsSUFBSSxjQUFjLGlCQUFpQjtBQUN6RSxrQkFBTSxRQUFRLE9BQU8sY0FBYyxPQUFPO0FBRTFDLGdCQUFJLE9BQU87QUFDVixvQkFBTSxVQUFRLFdBQU0sY0FBYyxPQUFPLE1BQTNCLG1CQUE4QixnQkFBZTtBQUMzRCxvQkFBTSxVQUFVLE1BQU0sS0FBSyxNQUFNLGlCQUFpQixhQUFhLENBQUMsRUFBRSxJQUFJLFFBQU0sR0FBRyxXQUFXLEVBQUUsS0FBSyxJQUFJLEtBQUs7QUFDMUcsb0JBQU0sc0JBQXFCLFdBQU0sY0FBYyxXQUFXLE1BQS9CLG1CQUFrQztBQUM3RCxvQkFBTSxrQkFBa0IscUJBQXNCLElBQUksS0FBSyxrQkFBa0IsRUFBRyxZQUFZLEVBQUUsTUFBTSxHQUFHLEVBQUUsQ0FBQyxJQUFJO0FBQzFHLG9CQUFNQyxTQUFNLFdBQU0sY0FBYyxJQUFJLE1BQXhCLG1CQUEyQixnQkFBZTtBQUN0RCxrQkFBSSxZQUFVLFdBQU0sY0FBYyxTQUFTLE1BQTdCLG1CQUFnQyxnQkFBZTtBQUM3RCx3QkFBVSxRQUFRLFFBQVEsa0JBQWtCLEdBQUcsRUFBRSxLQUFLO0FBQ3RELG9CQUFNLFlBQVUsWUFBTyxjQUFjLG1CQUFtQixNQUF4QyxtQkFBMkMsYUFBYSxZQUFXO0FBRW5GLGtCQUFJLFNBQVMsUUFBVTtBQUN0Qix1QkFBTztBQUFBLGNBQ1I7QUFDQSxjQUFBRCxTQUFRLEVBQUUsT0FBTyxTQUFTLGlCQUFpQixTQUFVLElBQUksS0FBQUMsTUFBSyxTQUFTLEtBQUksQ0FBQztBQUFBLFlBQzdFLE9BQU87QUFDTixxQkFBTyxJQUFJLE1BQU0sZ0NBQWdDLENBQUM7QUFBQSxZQUNuRDtBQUFBLFVBQ0QsT0FBTztBQUNOLG1CQUFPLElBQUksTUFBTSxzQkFBc0IsQ0FBQztBQUFBLFVBQ3pDO0FBQUEsUUFDRDtBQUFBLE1BQ0Q7QUFDQSxVQUFJLEtBQUs7QUFBQSxJQUNWLENBQUM7QUFBQSxFQUNGO0FBQUEsRUFFQSxNQUFNLFdBQVcsTUFBZ0M7QUFDaEQsVUFBTSxjQUFjLEtBQUssUUFBUSxNQUFNLElBQUksRUFBRSxJQUFJLFlBQVUsUUFBUSxTQUFTLEVBQUUsS0FBSyxJQUFJO0FBQ3ZGLFVBQU0sY0FBYztBQUFBLFVBQ1osS0FBSztBQUFBO0FBQUEsRUFFYjtBQUFBLGNBQ1ksS0FBSztBQUFBLFVBQ1QsS0FBSztBQUFBLFVBQ0wsS0FBSztBQUFBO0FBQUE7QUFJYixVQUFNLFVBQVU7QUFBQTtBQUFBO0FBQUEsRUFHaEIsS0FBSztBQUFBO0FBR0wsVUFBTSxLQUFLLElBQUksTUFBTSxPQUFPLEdBQUcsS0FBSyxTQUFTLGFBQWEsS0FBSyxXQUFXLGNBQWMsT0FBTztBQUMvRixRQUFJLHVCQUFPLGlCQUFpQixLQUFLLE1BQU07QUFBQSxFQUN4QztBQUFBLEVBQ0EsTUFBTSxTQUFTO0FBQ2QsVUFBTSxLQUFLLGFBQWE7QUFFeEIsUUFBSTtBQUNILFlBQU0sWUFBWSxNQUFNLEtBQUssWUFBWTtBQUN6QyxtQ0FBUSxTQUFTLFNBQVM7QUFFMUIsWUFBTSxlQUFlLEtBQUssY0FBYyxTQUFTLHFCQUFxQixNQUFNO0FBQzNFLFlBQUksV0FBVyxLQUFLLEtBQUssQ0FBQyxTQUFTLGNBQWM7QUFDakQsZUFBSyxXQUFXLFNBQVMsU0FBUztBQUFBLFFBQ2xDLENBQUMsRUFBRSxLQUFLO0FBQUEsTUFDVCxDQUFDO0FBQ0QsbUJBQWEsU0FBUyx3QkFBd0I7QUFBQSxJQUUvQyxTQUFTLE9BQVA7QUFDRCxjQUFRLE1BQU0sVUFBVSxLQUFLO0FBQUEsSUFDOUI7QUFJQSxVQUFNLGtCQUFrQixLQUFLLGlCQUFpQjtBQUM5QyxvQkFBZ0IsUUFBUSxpQkFBaUI7QUFHekMsU0FBSyxXQUFXO0FBQUEsTUFDZixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixVQUFVLE1BQU07QUFDZixZQUFJLFdBQVcsS0FBSyxLQUFLLENBQUMsU0FBUyxjQUFjO0FBQ2pELGVBQUssV0FBVyxTQUFTLFNBQVM7QUFBQSxRQUNsQyxDQUFDLEVBQUUsS0FBSztBQUFBLE1BQ1Q7QUFBQSxJQUNELENBQUM7QUFHRCxTQUFLLGNBQWMsSUFBSSxnQkFBZ0IsS0FBSyxLQUFLLElBQUksQ0FBQztBQUFBLEVBRXZEO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFFWDtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ3BCLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixNQUFNLEtBQUssU0FBUyxDQUFDO0FBQUEsRUFDMUU7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNwQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFBQSxFQUNsQztBQUFBLEVBQ0EsTUFBTSxjQUErQjtBQUVwQyxVQUFNLFdBQWdCO0FBQUEsTUFDckIsS0FBSyxJQUFJLE1BQU0sUUFBUTtBQUFBLE1BQ3ZCLEtBQUssU0FBUztBQUFBLE1BQ2Q7QUFBQSxJQUNEO0FBRUEsV0FBTyxJQUFJLFFBQVEsQ0FBQ0QsVUFBUyxXQUFXO0FBQ3ZDLE1BQUcsWUFBUyxVQUFVLFFBQVEsQ0FBQyxLQUFLLFNBQVM7QUFDNUMsWUFBSSxLQUFLO0FBQ1Isa0JBQVEsTUFBTSwyQkFBMkIsR0FBRztBQUM1QyxpQkFBTyxHQUFHO0FBQUEsUUFDWCxPQUFPO0FBQ04sVUFBQUEsU0FBUSxJQUFJO0FBQUEsUUFDYjtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUFBLEVBQ0Y7QUFDRDtBQUdBLElBQU0sa0JBQU4sY0FBOEIsaUNBQWlCO0FBQUEsRUFHOUMsWUFBWSxLQUFVLFFBQXFCO0FBQzFDLFVBQU0sS0FBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2Y7QUFBQSxFQUVBLFVBQWdCO0FBQ2YsVUFBTSxFQUFDLFlBQVcsSUFBSTtBQUV0QixnQkFBWSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUNyQixRQUFRLFdBQVcsRUFDbkIsUUFBUSxnREFBZ0QsRUFDeEQsUUFBUSxVQUFRLEtBQ2YsU0FBUyxLQUFLLE9BQU8sU0FBUyxTQUFTLEVBQ3ZDLFNBQVMsT0FBTyxVQUFVO0FBQzFCLGNBQVEsSUFBSSxtQkFBbUIsS0FBSztBQUNwQyxXQUFLLE9BQU8sU0FBUyxZQUFZO0FBQ2pDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNoQyxDQUFDLENBQUM7QUFBQSxFQUNMO0FBQ0Q7QUFFQSxJQUFNLGFBQU4sY0FBeUIsc0JBQU07QUFBQSxFQUs3QixZQUFZLEtBQVUsVUFBd0Q7QUFDNUUsVUFBTSxHQUFHO0FBQ1QsU0FBSyxXQUFXO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFNBQVM7QUFDUCxVQUFNLEVBQUUsVUFBVSxJQUFJO0FBR3RCLFFBQUksd0JBQVEsU0FBUyxFQUNsQixRQUFRLFdBQVcsRUFDbkIsUUFBUSxDQUFDLFNBQ1IsS0FBSyxTQUFTLENBQUMsVUFBVTtBQUN2QixXQUFLLFVBQVU7QUFBQSxJQUNqQixDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFNBQVMsRUFDbEIsUUFBUSx3QkFBd0IsRUFDaEMsUUFBUSxDQUFDLFNBQ1IsS0FBSyxTQUFTLENBQUMsVUFBVTtBQUN2QixXQUFLLFlBQVk7QUFBQSxJQUNuQixDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFNBQVMsRUFDbEIsVUFBVSxDQUFDLFFBQ1YsSUFDRyxjQUFjLE9BQU8sRUFDckIsT0FBTyxFQUNQLFFBQVEsTUFBTTtBQUNiLFdBQUssTUFBTTtBQUNYLFdBQUssU0FBUyxLQUFLLFNBQVMsS0FBSyxTQUFTO0FBQUEsSUFDNUMsQ0FBQyxDQUFDO0FBQUEsRUFDVjtBQUFBLEVBRUEsVUFBVTtBQUNSLFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBQUEsRUFDbEI7QUFDRjtBQUVBLElBQU8sZUFBUTsiLAogICJuYW1lcyI6IFsicmVzb2x2ZSIsICJ1cmwiXQp9Cg==
