/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => main_default
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var fs = __toESM(require("fs"));
var path = __toESM(require("path"));
var DEFAULT_SETTINGS = {
  mySetting: "",
  enableRibbonIcon: false
};
var ArxivPlugin = class extends import_obsidian.Plugin {
  async fetchPaper(paperId, paperName) {
    if (paperId) {
      try {
        const data = await this.fetchPaperData(paperId, paperName);
        await this.createNote(data);
      } catch (error) {
        console.error("Error fetching paper data:", error);
        new import_obsidian.Notice(`Error fetching paper data: ${paperId}`);
      }
    }
  }
  fetchPaperData(id, name) {
    return new Promise((resolve2, reject) => {
      const url = `http://export.arxiv.org/api/query?id_list=${id}`;
      const xhr = new XMLHttpRequest();
      xhr.open("GET", url);
      xhr.onreadystatechange = () => {
        var _a, _b, _c, _d, _e;
        if (xhr.readyState === 4) {
          if (xhr.status === 200) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xhr.responseText, "application/xml");
            const entry = xmlDoc.querySelector("entry");
            if (entry) {
              const title = ((_a = entry.querySelector("title")) == null ? void 0 : _a.textContent) || "No Title";
              const authors = Array.from(entry.querySelectorAll("author name")).map((el) => el.textContent).join(", ") || "No Authors";
              const publicationDateRaw = (_b = entry.querySelector("published")) == null ? void 0 : _b.textContent;
              const publicationDate = publicationDateRaw ? new Date(publicationDateRaw).toISOString().split("T")[0] : "No Publication Date";
              const url2 = ((_c = entry.querySelector("id")) == null ? void 0 : _c.textContent) || "No URL";
              let summary = ((_d = entry.querySelector("summary")) == null ? void 0 : _d.textContent) || "No Summary";
              summary = summary.replace(/(\r\n|\n|\r)/gm, " ").trim();
              const pdfLink = ((_e = xmlDoc.querySelector('link[title="pdf"]')) == null ? void 0 : _e.getAttribute("href")) || "No PDF Link";
              if (name === void 0) {
                name = id;
              }
              resolve2({ title, authors, publicationDate, summary, id, url: url2, pdfLink, name });
            } else {
              reject(new Error("No entry found in the response"));
            }
          } else {
            reject(new Error("Failed to fetch data"));
          }
        }
      };
      xhr.send();
    });
  }
  async createNote(data) {
    const authorsList = data.authors.split(", ").map((author) => `  - "${author}"`).join("\n");
    const frontMatter = `---
title: "${data.title}"
authors:
${authorsList}
published: "${data.publicationDate}"
arXiv: "${data.url}"
paper: "${data.pdfLink}"
---
`;
    const content = `
#### Abstract

${data.summary}
		`;
    await this.app.vault.create(`${this.settings.mySetting}/${data.name}.md`, frontMatter + content);
    new import_obsidian.Notice(`Created note: ${data.name}`);
  }
  async onload() {
    await this.loadSettings();
    this.arXivLogo = await this.readSVGFile();
    this.enableRibbonIcon();
    const statusBarItemEl = this.addStatusBarItem();
    statusBarItemEl.setText("Status Bar Text");
    this.addCommand({
      id: "open-arXiv-modal",
      name: "Fetch arXiv paper info",
      callback: () => {
        new ArXivModal(this.app, (paperId, paperName) => {
          this.fetchPaper(paperId, paperName);
        }).open();
      }
    });
    this.addSettingTab(new ArXivSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async readSVGFile() {
    const filePath = path.resolve(
      this.app.vault.adapter.basePath,
      this.manifest.dir,
      "arxiv-logomark.svg"
    );
    return new Promise((resolve2, reject) => {
      fs.readFile(filePath, "utf8", (err, data) => {
        if (err) {
          console.error("Error reading SVG file:", err);
          reject("");
        } else {
          resolve2(data);
        }
      });
    });
  }
  enableRibbonIcon() {
    var _a;
    if (this.settings.enableRibbonIcon & this.arXivLogo != "") {
      (0, import_obsidian.addIcon)("arXiv", this.arXivLogo);
      this.addRibbonIcon("arXiv", "arXiv fetch paper", () => {
        new ArXivModal(this.app, (paperId, paperName) => {
          this.fetchPaper(paperId, paperName);
        }).open();
      }).setAttribute("id", "rb-arXiv-icon");
    } else {
      (_a = document.getElementById("rb-arXiv-icon")) == null ? void 0 : _a.remove();
    }
  }
};
var ArXivSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Save path").setDesc("Enter the path where you want to save the file").addText(
      (text) => text.setValue(this.plugin.settings.mySetting).onChange(async (value) => {
        this.plugin.settings.mySetting = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Enable ribbon icon").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.enableRibbonIcon).onChange((value) => {
        this.plugin.settings.enableRibbonIcon = value;
        this.plugin.saveSettings();
        this.plugin.enableRibbonIcon();
      })
    );
  }
};
var ArXivModal = class extends import_obsidian.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    new import_obsidian.Setting(contentEl).setName("arXiv id:").addText((text) => text.onChange((value) => {
      this.arXivID = value;
    }));
    new import_obsidian.Setting(contentEl).setName("Paper name (optional):").addText((text) => text.onChange((value) => {
      this.paperName = value;
    }));
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Fetch").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.arXivID, this.paperName);
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var main_default = ArxivPlugin;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBFZGl0b3IsIE1hcmtkb3duVmlldywgYWRkSWNvbiwgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuLy8gUmVtZW1iZXIgdG8gcmVuYW1lIHRoZXNlIGNsYXNzZXMgYW5kIGludGVyZmFjZXMhXG5cbmludGVyZmFjZSBBclhpdlBsdWdpblNldHRpbmdzIHtcblx0bXlTZXR0aW5nOiBzdHJpbmc7XG5cdGVuYWJsZVJpYmJvbkljb246IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBQYXBlckRhdGEge1xuICB0aXRsZTogc3RyaW5nO1xuICBhdXRob3JzOiBzdHJpbmc7XG4gIHB1YmxpY2F0aW9uRGF0ZTogc3RyaW5nO1xuICBzdW1tYXJ5OiBzdHJpbmc7XG4gIGlkOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBwZGZMaW5rOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQXJYaXZQbHVnaW5TZXR0aW5ncyA9IHtcblx0bXlTZXR0aW5nOiAnJyxcblx0ZW5hYmxlUmliYm9uSWNvbjogZmFsc2UsXG59XG5cbmNsYXNzIEFyeGl2UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IEFyWGl2UGx1Z2luU2V0dGluZ3M7XG5cblx0YXN5bmMgZmV0Y2hQYXBlcihwYXBlcklkOiBzdHJpbmcsIHBhcGVyTmFtZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0aWYgKHBhcGVySWQpIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmZldGNoUGFwZXJEYXRhKHBhcGVySWQsIHBhcGVyTmFtZSk7XG5cdFx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlTm90ZShkYXRhKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBhcGVyIGRhdGE6JywgZXJyb3IpO1xuXHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBmZXRjaGluZyBwYXBlciBkYXRhOiAke3BhcGVySWR9YCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0ZmV0Y2hQYXBlckRhdGEoaWQ6IHN0cmluZywgbmFtZTpzdHJpbmcpOiBQcm9taXNlPFBhcGVyRGF0YT4ge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRjb25zdCB1cmwgPSBgaHR0cDovL2V4cG9ydC5hcnhpdi5vcmcvYXBpL3F1ZXJ5P2lkX2xpc3Q9JHtpZH1gO1xuXHRcdFx0XHRjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0XHRcdHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuXHRcdFx0eGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcblx0XHRcdFx0aWYgKHhoci5yZWFkeVN0YXRlID09PSA0KSB7XG5cdFx0XHRcdFx0aWYgKHhoci5zdGF0dXMgPT09IDIwMCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHRcdFx0XHRcdFx0Y29uc3QgeG1sRG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyh4aHIucmVzcG9uc2VUZXh0LCAnYXBwbGljYXRpb24veG1sJyk7XG5cdFx0XHRcdFx0XHRjb25zdCBlbnRyeSA9IHhtbERvYy5xdWVyeVNlbGVjdG9yKCdlbnRyeScpO1xuXG5cdFx0XHRcdFx0XHRpZiAoZW50cnkpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGl0bGUgPSBlbnRyeS5xdWVyeVNlbGVjdG9yKCd0aXRsZScpPy50ZXh0Q29udGVudCB8fCAnTm8gVGl0bGUnO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBhdXRob3JzID0gQXJyYXkuZnJvbShlbnRyeS5xdWVyeVNlbGVjdG9yQWxsKCdhdXRob3IgbmFtZScpKS5tYXAoZWwgPT4gZWwudGV4dENvbnRlbnQpLmpvaW4oJywgJykgfHwgJ05vIEF1dGhvcnMnO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwdWJsaWNhdGlvbkRhdGVSYXcgPSBlbnRyeS5xdWVyeVNlbGVjdG9yKCdwdWJsaXNoZWQnKT8udGV4dENvbnRlbnQ7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHB1YmxpY2F0aW9uRGF0ZSA9IHB1YmxpY2F0aW9uRGF0ZVJhdyA/IChuZXcgRGF0ZShwdWJsaWNhdGlvbkRhdGVSYXcpKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0gOiAnTm8gUHVibGljYXRpb24gRGF0ZSc7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHVybCA9IGVudHJ5LnF1ZXJ5U2VsZWN0b3IoJ2lkJyk/LnRleHRDb250ZW50IHx8ICdObyBVUkwnO1xuXHRcdFx0XHRcdFx0XHRsZXQgc3VtbWFyeSA9IGVudHJ5LnF1ZXJ5U2VsZWN0b3IoJ3N1bW1hcnknKT8udGV4dENvbnRlbnQgfHwgJ05vIFN1bW1hcnknO1xuXHRcdFx0XHRcdFx0XHRzdW1tYXJ5ID0gc3VtbWFyeS5yZXBsYWNlKC8oXFxyXFxufFxcbnxcXHIpL2dtLCBcIiBcIikudHJpbSgpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBwZGZMaW5rID0geG1sRG9jLnF1ZXJ5U2VsZWN0b3IoJ2xpbmtbdGl0bGU9XCJwZGZcIl0nKT8uZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgJ05vIFBERiBMaW5rJztcblxuXHRcdFx0XHRcdFx0XHRpZiAobmFtZSA9PT0gdW5kZWZpbmVkKXtcblx0XHRcdFx0XHRcdFx0XHRuYW1lID0gaWQ7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0cmVzb2x2ZSh7IHRpdGxlLCBhdXRob3JzLCBwdWJsaWNhdGlvbkRhdGUsIHN1bW1hcnkgLCBpZCwgdXJsLCBwZGZMaW5rLCBuYW1lfSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKCdObyBlbnRyeSBmb3VuZCBpbiB0aGUgcmVzcG9uc2UnKSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJlamVjdChuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBkYXRhJykpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdHhoci5zZW5kKCk7XG5cdFx0fSk7XG5cdH1cblxuXHRhc3luYyBjcmVhdGVOb3RlKGRhdGE6IFBhcGVyRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGF1dGhvcnNMaXN0ID0gZGF0YS5hdXRob3JzLnNwbGl0KCcsICcpLm1hcChhdXRob3IgPT4gYCAgLSBcIiR7YXV0aG9yfVwiYCkuam9pbignXFxuJyk7XG5cdFx0Y29uc3QgZnJvbnRNYXR0ZXIgPSBgLS0tXG50aXRsZTogXCIke2RhdGEudGl0bGV9XCJcbmF1dGhvcnM6XG4ke2F1dGhvcnNMaXN0fVxucHVibGlzaGVkOiBcIiR7ZGF0YS5wdWJsaWNhdGlvbkRhdGV9XCJcbmFyWGl2OiBcIiR7ZGF0YS51cmx9XCJcbnBhcGVyOiBcIiR7ZGF0YS5wZGZMaW5rfVwiXG4tLS1cbmA7XG5cblx0XHRjb25zdCBjb250ZW50ID0gYFxuIyMjIyBBYnN0cmFjdFxuXG4ke2RhdGEuc3VtbWFyeX1cblx0XHRgO1xuXG5cdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGAke3RoaXMuc2V0dGluZ3MubXlTZXR0aW5nfS8ke2RhdGEubmFtZX0ubWRgLCBmcm9udE1hdHRlciArIGNvbnRlbnQpO1xuXHRcdG5ldyBOb3RpY2UoYENyZWF0ZWQgbm90ZTogJHtkYXRhLm5hbWV9YCk7XG5cdH1cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0dGhpcy5hclhpdkxvZ28gPSBhd2FpdCB0aGlzLnJlYWRTVkdGaWxlKCk7XG5cdFx0dGhpcy5lbmFibGVSaWJib25JY29uKCk7XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzdGF0dXMgYmFyIGl0ZW0gdG8gdGhlIGJvdHRvbSBvZiB0aGUgYXBwLiBEb2VzIG5vdCB3b3JrIG9uIG1vYmlsZSBhcHBzLlxuXHRcdGNvbnN0IHN0YXR1c0Jhckl0ZW1FbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xuXHRcdHN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdTdGF0dXMgQmFyIFRleHQnKTtcblxuXHRcdC8vIFRoaXMgYWRkcyBhIHNpbXBsZSBjb21tYW5kIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBhbnl3aGVyZVxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ29wZW4tYXJYaXYtbW9kYWwnLFxuXHRcdFx0bmFtZTogJ0ZldGNoIGFyWGl2IHBhcGVyIGluZm8nLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0bmV3IEFyWGl2TW9kYWwodGhpcy5hcHAsIChwYXBlcklkLCBwYXBlck5hbWUpID0+IHtcblx0XHRcdFx0dGhpcy5mZXRjaFBhcGVyKHBhcGVySWQsIHBhcGVyTmFtZSk7XG5cdFx0XHRcdH0pLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFRoaXMgYWRkcyBhIHNldHRpbmdzIHRhYiBzbyB0aGUgdXNlciBjYW4gY29uZmlndXJlIHZhcmlvdXMgYXNwZWN0cyBvZiB0aGUgcGx1Z2luXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBBclhpdlNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuXHR9XG5cblx0b251bmxvYWQoKSB7XG5cblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cdGFzeW5jIHJlYWRTVkdGaWxlKCk6IFByb21pc2U8c3RyaW5nPiB7XG5cblx0XHRjb25zdCBmaWxlUGF0aCA9IHBhdGgucmVzb2x2ZShcblx0XHRcdHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuYmFzZVBhdGgsIFxuXHRcdFx0dGhpcy5tYW5pZmVzdC5kaXIsXG5cdFx0XHQnYXJ4aXYtbG9nb21hcmsuc3ZnJ1xuXHRcdCk7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0ZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGY4JywgKGVyciwgZGF0YSkgPT4ge1xuXHRcdFx0XHRpZiAoZXJyKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyBTVkcgZmlsZTonLCBlcnIpO1xuXHRcdFx0XHRcdHJlamVjdCgnJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmVzb2x2ZShkYXRhKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRlbmFibGVSaWJib25JY29uKCl7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlUmliYm9uSWNvbiAmIHRoaXMuYXJYaXZMb2dvICE9ICcnKSB7XG5cblx0XHRcdGFkZEljb24oJ2FyWGl2JywgdGhpcy5hclhpdkxvZ28pO1xuXHRcdFx0dGhpcy5hZGRSaWJib25JY29uKFwiYXJYaXZcIiwgXCJhclhpdiBmZXRjaCBwYXBlclwiLCAoKSA9PiB7XG5cdFx0XHRcdG5ldyBBclhpdk1vZGFsKHRoaXMuYXBwLCAocGFwZXJJZCwgcGFwZXJOYW1lKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5mZXRjaFBhcGVyKHBhcGVySWQsIHBhcGVyTmFtZSk7XG5cdFx0XHRcdH0pLm9wZW4oKTtcblx0XHRcdH0pLnNldEF0dHJpYnV0ZSgnaWQnLCAncmItYXJYaXYtaWNvbicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmItYXJYaXYtaWNvbicpPy5yZW1vdmUoKTtcblx0XHR9XG5cblx0fVxufVxuXG5cbmNsYXNzIEFyWGl2U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEFyeGl2UGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEFyeGl2UGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHQuc2V0TmFtZSgnU2F2ZSBwYXRoJylcblx0XHQuc2V0RGVzYygnRW50ZXIgdGhlIHBhdGggd2hlcmUgeW91IHdhbnQgdG8gc2F2ZSB0aGUgZmlsZScpXG5cdFx0LmFkZFRleHQoXG5cdFx0XHR0ZXh0ID0+IHRleHRcblx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5teVNldHRpbmcpXG5cdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm15U2V0dGluZyA9IHZhbHVlO1xuXHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdH0pKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ0VuYWJsZSByaWJib24gaWNvbicpXG5cdFx0XHQuYWRkVG9nZ2xlKFxuXHRcdFx0XHQodG9nZ2xlKSA9PiB0b2dnbGVcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVJpYmJvbkljb24pXG5cdFx0XHRcdC5vbkNoYW5nZSgodmFsdWUpID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVSaWJib25JY29uID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uZW5hYmxlUmliYm9uSWNvbigpXG5cdFx0XHRcdH0pKTtcblx0fVxufVxuXG5jbGFzcyBBclhpdk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICBhclhpdklEOiBzdHJpbmc7XG4gIHBhcGVyTmFtZTogc3RyaW5nO1xuICBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBvblN1Ym1pdDogKGFyWGl2SUQ6IHN0cmluZywgcGFwZXJOYW1lOiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuXG4gICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgLnNldE5hbWUoXCJhclhpdiBpZDpcIilcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxuICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMuYXJYaXZJRCA9IHZhbHVlXG4gICAgICAgIH0pKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgIC5zZXROYW1lKFwiUGFwZXIgbmFtZSAob3B0aW9uYWwpOlwiKVxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIHRleHQub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wYXBlck5hbWUgPSB2YWx1ZVxuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgIGJ0blxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiRmV0Y2hcIilcbiAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMuYXJYaXZJRCwgdGhpcy5wYXBlck5hbWUpO1xuICAgICAgICAgIH0pKTtcbiAgfVxuXG4gIG9uQ2xvc2UoKSB7XG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgY29udGVudEVsLmVtcHR5KCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXJ4aXZQbHVnaW47XG5cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQXFHO0FBQ3JHLFNBQW9CO0FBQ3BCLFdBQXNCO0FBb0J0QixJQUFNLG1CQUF3QztBQUFBLEVBQzdDLFdBQVc7QUFBQSxFQUNYLGtCQUFrQjtBQUNuQjtBQUVBLElBQU0sY0FBTixjQUEwQix1QkFBTztBQUFBLEVBR2hDLE1BQU0sV0FBVyxTQUFpQixXQUFrQztBQUNuRSxRQUFJLFNBQVM7QUFDWixVQUFJO0FBQ0gsY0FBTSxPQUFPLE1BQU0sS0FBSyxlQUFlLFNBQVMsU0FBUztBQUN6RCxjQUFNLEtBQUssV0FBVyxJQUFJO0FBQUEsTUFDM0IsU0FBUyxPQUFQO0FBQ0QsZ0JBQVEsTUFBTSw4QkFBOEIsS0FBSztBQUNqRCxZQUFJLHVCQUFPLDhCQUE4QixTQUFTO0FBQUEsTUFDbkQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUFBLEVBRUEsZUFBZSxJQUFZLE1BQWlDO0FBQzNELFdBQU8sSUFBSSxRQUFRLENBQUNBLFVBQVMsV0FBVztBQUN2QyxZQUFNLE1BQU0sNkNBQTZDO0FBQ3hELFlBQU0sTUFBTSxJQUFJLGVBQWU7QUFDaEMsVUFBSSxLQUFLLE9BQU8sR0FBRztBQUNuQixVQUFJLHFCQUFxQixNQUFNO0FBL0Ns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WSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUN0QixRQUFRLFdBQVcsRUFDbkIsUUFBUSxnREFBZ0QsRUFDeEQ7QUFBQSxNQUNBLFVBQVEsS0FDUCxTQUFTLEtBQUssT0FBTyxTQUFTLFNBQVMsRUFDdkMsU0FBUyxPQUFPLFVBQVU7QUFDMUIsYUFBSyxPQUFPLFNBQVMsWUFBWTtBQUNqQyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDaEMsQ0FBQztBQUFBLElBQUM7QUFFSCxRQUFJLHdCQUFRLFdBQVcsRUFDckIsUUFBUSxvQkFBb0IsRUFDNUI7QUFBQSxNQUNBLENBQUMsV0FBVyxPQUNYLFNBQVMsS0FBSyxPQUFPLFNBQVMsZ0JBQWdCLEVBQzlDLFNBQVMsQ0FBQyxVQUFVO0FBQ3BCLGFBQUssT0FBTyxTQUFTLG1CQUFtQjtBQUN4QyxhQUFLLE9BQU8sYUFBYTtBQUN6QixhQUFLLE9BQU8saUJBQWlCO0FBQUEsTUFDOUIsQ0FBQztBQUFBLElBQUM7QUFBQSxFQUNMO0FBQ0Q7QUFFQSxJQUFNLGFBQU4sY0FBeUIsc0JBQU07QUFBQSxFQUs3QixZQUFZLEtBQVUsVUFBd0Q7QUFDNUUsVUFBTSxHQUFHO0FBQ1QsU0FBSyxXQUFXO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFNBQVM7QUFDUCxVQUFNLEVBQUUsVUFBVSxJQUFJO0FBR3RCLFFBQUksd0JBQVEsU0FBUyxFQUNsQixRQUFRLFdBQVcsRUFDbkIsUUFBUSxDQUFDLFNBQ1IsS0FBSyxTQUFTLENBQUMsVUFBVTtBQUN2QixXQUFLLFVBQVU7QUFBQSxJQUNqQixDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFNBQVMsRUFDbEIsUUFBUSx3QkFBd0IsRUFDaEMsUUFBUSxDQUFDLFNBQ1IsS0FBSyxTQUFTLENBQUMsVUFBVTtBQUN2QixXQUFLLFlBQVk7QUFBQSxJQUNuQixDQUFDLENBQUM7QUFFTixRQUFJLHdCQUFRLFNBQVMsRUFDbEIsVUFBVSxDQUFDLFFBQ1YsSUFDRyxjQUFjLE9BQU8sRUFDckIsT0FBTyxFQUNQLFFBQVEsTUFBTTtBQUNiLFdBQUssTUFBTTtBQUNYLFdBQUssU0FBUyxLQUFLLFNBQVMsS0FBSyxTQUFTO0FBQUEsSUFDNUMsQ0FBQyxDQUFDO0FBQUEsRUFDVjtBQUFBLEVBRUEsVUFBVTtBQUNSLFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBQUEsRUFDbEI7QUFDRjtBQUVBLElBQU8sZUFBUTsiLAogICJuYW1lcyI6IFsicmVzb2x2ZSIsICJ1cmwiXQp9Cg==
